/**
 * @gdjiami/gzb-jssdk - 1.1.26-beta
 * https://github.com/jmopen/gzb-jssdk#readme
 * Copyright(c) 2018 ivan
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.GZB={})}(this,function(e){"use strict";function t(e,t){function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function n(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function r(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e}function i(e){if(null==e)return e;if("string"==typeof e)return e.length>2e3?e.substr(0,2e3)+"...":e;if(Array.isArray(e))return e.map(i);if("object"==typeof e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=i(e[n]));return t}return e}function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}function a(e,t,n){if(o("[GZB JSSDK deprecated]: "+e),t)return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return t.apply(n,e)}}function s(){}function c(e){return e}function l(e){return""+e.substr(0,1).toUpperCase()+e.substr(1)}function u(e,t){if(void 0===t&&(t=!1),!(e instanceof Date)){if("string"==typeof e){var n=new Date(e);if(Number.isNaN(n.getTime())){var r=Number.parseInt(e);if(Number.isNaN(r))throw new TypeError(e+" is not a valid Date");return t?new Date(1e3*r):new Date(r)}return n}return t?new Date(1e3*e):new Date(e)}return e}function d(e,t){return e<72.004||t>137.8347||(e<.8293||t>55.8271)}function p(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function f(e,t,n){void 0===n&&(n=0);var r=null==e?0:e.length;if(!r)return-1;return void 0!==n&&(n<0?Math.max(r+n,0):Math.min(n,r-1)),p(e,t,n,!1)}function h(e){return"string"==typeof e?JSON.parse(e):e}function g(e,t){return"'"+e+"' 方法已经废弃, 请使用 "+t+" 方法代替."}function y(e){a(e+" 方法: 回调形式的API调用已经废弃， 请使用Promise来获取返回值和捕获错误")}function v(){return(I.mobile()?V:G).getInstance()}var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},B=Object.freeze({bigStringTransform:i,debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},warn:o,deprecated:a,noop:s,identity:c,upperFirst:l,parseDate:u,dateFormat:function(e,t,n){void 0===e&&(e=new Date),void 0===t&&(t="YYYY-MM-DD"),void 0===n&&(n=!1);var r=u(e,n),i=r.getFullYear(),o=r.getMonth()+1,a=r.getDate(),s=r.getHours(),c=s<=12?s:s-12,l=r.getMinutes(),d=r.getSeconds(),p={YYYY:i,MM:("0"+o).slice(-2),M:o,DD:("0"+a).slice(-2),D:a,H:s,HH:("0"+s).slice(-2),h:c,hh:("0"+c).slice(-2),m:l,mm:("0"+l).slice(-2),s:d,ss:("0"+d).slice(-2)};return t.replace(/Y+|M+|D+|H+|h+|m+|s+/g,function(e){return p[e]})},outOfChina:d,findIndex:f}),m=0,k={beforeSend:function(e){return e?JSON.stringify(e):void 0},afterReceived:c,preserveName:!1},H=function(){function e(){this.listeners={},this.responseCallbacks={},void 0===window.HandleEvent&&console.warn("[Window Bridge] 初始化异常，window.HandleEvent 为undefined. 这可能说明SDK运行在没有Bridge的环境\n        请使用Device.bridgeAvailable()来判断当前环境是否支持。\n        ")}return e.getInstance=function(){return null==this.instance?this.instance=new e:this.instance},e.getNormalizedBridge=function(){var e=this.getInstance();return null==this.normalizedBridge?this.normalizedBridge={callHandler:function(t,n,r){e.emit("[s]"+t,n,r)},registerHandler:function(t,n){e.addListener("[c]"+t,n)}}:this.normalizedBridge},e.prototype.emit=function(e,t,n){var r=this,i=this.listeners[e];if(!i||!i.length)throw new Error("[Windows Bridge]: "+e+" not registered(PC 端未支持该接口)");i.forEach(function(e){return e.call(r,t,n)})},e.prototype.addListener=function(e,t){var n=this,r=this.listeners[e]||[];return this.listeners[e]=r.concat(t),function(){n.removeListener(e,t)}},e.prototype.removeListener=function(e,t){var n=this.listeners[e];if(n&&n.length){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}},e.prototype.addCallback=function(e,t,n){return void 0===n&&(n="cb_"+e+"_"+m++),this.responseCallbacks[n]=t,n},e.prototype.callCallback=function(e,t){var n=this.responseCallbacks[e];n&&n(t),delete this.responseCallbacks[e]},e.prototype.registerHandler=function(e,t){var n=this;void 0===t&&(t={});var r=w({},k,t);return this.registerBridgeHandler(e,function(t,i){var o;"function"==typeof i&&(o=n.addCallback(e,function(e){i(r.afterReceived(e))}));var a=r.bridgeHandleName||(r.preserveName?e:"On"+l(e)),s=r.beforeSend(t);window.HandleEvent(a,s,o)}),this},e.prototype.deprecatedRegisterHandler=function(e,t){return this.registerBridgeHandler.call(this,e,t),this},e.prototype.callClientHandler=function(e,t,n){this.emit("[c]"+e,t,n)},e.prototype.registerBridgeHandler=function(e,t){this.addListener("[s]"+e,t)},e}();window.exeCallback=function(e,t){H.getInstance().callCallback(t,e)};var W=function(){function e(){this.androidBridgeInitialized=!1}return e.getInstance=function(){return this.instance?this.instance:this.instance=new e},e.prototype.setUpBridge=function(e){var t=this,n=e;if(n=function(t){var n=w({},t),r=t.callHandler;n.callHandler=function(e,t,n){return r(e,t,function(e){e&&"string"==typeof e&&(e=JSON.parse(e)),"function"==typeof n&&n(e)})},e(n)},window.WebViewJavascriptBridge)void 0===window.WebViewJavascriptBridge.init&&(window.WebViewJavascriptBridge.init=s),!this.androidBridgeInitialized&&I.android()&&(window.WebViewJavascriptBridge.init(),this.androidBridgeInitialized=!0),n(window.WebViewJavascriptBridge);else if(window.WVJBCallbacks)window.WVJBCallbacks.push(n);else if(window.WVJBCallbacks=[n],I.android())document.addEventListener("WebViewJavascriptBridgeReady",function(){"function"==typeof window.WebViewJavascriptBridge.init&&(window.WebViewJavascriptBridge.init(),t.androidBridgeInitialized=!0);var e=window.WVJBCallbacks;delete window.WVJBCallbacks,e.forEach(function(e){e(window.WebViewJavascriptBridge)})},!1);else{var r=document.createElement("iframe");r.style.display="none",r.src="https://__bridge_loaded__",document.documentElement.appendChild(r),setTimeout(function(){document.documentElement.removeChild(r)},0)}},e}(),C=function(e){function n(t,r){var i=e.call(this,r)||this;return i.errCode=t,Object.setPrototypeOf(i,n.prototype),i}return t(n,e),n}(Error),U=function(){function e(){this.initializeUserAgent()}return e.prototype.webkit=function(){return this.find("applewebkit")},e.prototype.bridgeAvailable=function(){var e=this;return new Promise(function(t){if(null!=e.isBridgeAvailable)return t(e.isBridgeAvailable);if(e.windows())return t(e.isBridgeAvailable=null!=window.HandleEvent);if(e.mobile())if(null!=window.WebViewJavascriptBridge)t(e.isBridgeAvailable=!0);else{var n=!1;W.getInstance().setUpBridge(function(){t(e.isBridgeAvailable=n=!0)}),setTimeout(function(){n||(n=!0,t(e.isBridgeAvailable=!1))},1500)}})},e.prototype.windows=function(){return this.find("windows")},e.prototype.windowsPhone=function(){return this.windows()&&this.find("phone")},e.prototype.windowsTablet=function(){return this.windows()&&!this.find("phone")&&this.find("touch")},e.prototype.iphone=function(){return!this.windows()&&this.find("iphone")},e.prototype.ipad=function(){return this.find("ipad")},e.prototype.ipod=function(){return this.find("ipod")},e.prototype.ios=function(){return this.iphone()||this.ipad()||this.ipod()},e.prototype.android=function(){return!this.windows()&&this.find("android")},e.prototype.androidPhone=function(){return this.android()&&this.find("mobile")},e.prototype.androidTablet=function(){return this.android()&&!this.find("mobile")},e.prototype.blackberry=function(){return this.find("blackberry")||this.find("bb10")||this.find("rim")},e.prototype.blackberryPhone=function(){return this.blackberry()&&!this.find("tablet")},e.prototype.blackberryTablet=function(){return this.blackberry()&&this.find("tablet")},e.prototype.mobile=function(){return this.androidPhone()||this.iphone()||this.ipod()||this.windowsPhone()||this.blackberryPhone()},e.prototype.tablet=function(){return this.ipad()||this.androidTablet()||this.blackberryTablet()||this.windowsTablet()},e.prototype.desktop=function(){return!this.mobile()&&!this.tablet()},e.prototype.portrait=function(){return window.innerHeight/window.innerWidth>1},e.prototype.landscape=function(){return!this.portrait()},e.prototype.setUserAgent=function(e){this.userAgent=e},e.prototype.initializeUserAgent=function(){this.userAgent=window.navigator.userAgent.toLowerCase()},e.prototype.find=function(e){return-1!==this.userAgent.indexOf(e)},e}(),I=new U,L=function(){function e(e,t){this.cancelable=!1,this.timeStamp=Date.now(),this.eventPrevented=!1,this.type=e,t&&(this.cancelable=t.cancelable||!1)}return Object.defineProperty(e.prototype,"defaultPrevented",{get:function(){return this.eventPrevented},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){this.cancelable&&(this.eventPrevented=!0)},e}(),M=function(){function e(){this.listeners={}}return e.prototype.addListener=function(e,t,n,r){var i=this;void 0===r&&(r=!1);var o=this.listeners[e]||[],a={callback:t,context:n,once:r};return this.listeners[e]=o.concat(a),function(){return i.removeListener(e,t)}},e.prototype.once=function(e,t,n){return this.addListener(e,t,n,!0)},e.prototype.getListenerLength=function(e){return this.listeners[e]?this.listeners[e].length:0},e.prototype.removeAllListener=function(e){var t=(this.listeners[e]||[]).length;return delete this.listeners[e],t},e.prototype.removeListener=function(e,t,n){var r=this.listeners[e];if(r&&r.length){var i=f(r,function(e){var r=e.callback,i=e.context;return r===t&&i===n});if(-1!==i)return r.splice(i,1),!0}return!1},e.prototype.emit=function(e,t){var n=this.listeners[e],i=[];if(n&&n.length)for(var o=r(n),a=!1,s=0;s<o.length;s++){var c=o[s],l=c.callback,u=c.context;if(c.once&&this.removeListener(e,l,u),a)i.push(void 0);else{var d=l.call(u,t);!1===d&&(a=!0),i.push(d)}}return i},e}(),O="exitWebApp",_="ready",A=Object.freeze({beforeunload:"beforeunload",beforegoback:"beforegoback",ready:_}),E={hideMoreBtn:!1,left:["close","goback"],onlyCallBack:[],gobackUrl:"",right:""},D={enableHighAccuracy:!0,preferNative:!0,timeout:1/0,watch:!1,maximumAge:0},T={quality:100,targetType:"default",extType:[],maxSizeKb:0},N={multiple:!0},P=0,S=function(e){function n(){var t=e.call(this)||this;return t.menuItems={},t.isReady=!1,t.exit=function(){t.setUpBridge(function(e){e.callHandler(O,void 0)})},setTimeout(function(){t.setupEventWatchers(),I.bridgeAvailable().then(function(){var e=new L(_);t.emit(_,e),t.isReady=!0,t.innerAddEventListener("__addListener__",function(n){n===_&&t.emit(_,e)})})},0),t}return t(n,e),n.prototype.addListener=function(t,n,r){return this.emit("__addListener__",{eventType:t}),e.prototype.addListener.call(this,t,n,r)},n.prototype.removeListener=function(t,n,r){var i=e.prototype.removeListener.call(this,t,n,r);return i&&this.emit("__removeListener__",{eventType:t,count:1}),i},n.prototype.removeAllListener=function(t){var n=e.prototype.removeAllListener.call(this,t);return n&&this.emit("__removeListener__",{eventType:t,count:n}),n},n.prototype.setTitle=function(e){var t=this;I.bridgeAvailable().then(function(n){n?t.setUpBridge(function(t){t.callHandler("setWebTitle",{title:e})}):document.title=e})},n.prototype.phone=function(e){this.setUpBridge(function(t){t.callHandler("makeCallToNumber",{callNumber:e})})},n.prototype.sms=function(e){this.setUpBridge(function(t){t.callHandler("sendSmsToNumber",{callNumber:e})})},n.prototype.mail=function(e){var t=this;I.bridgeAvailable().then(function(n){if(n)t.setUpBridge(function(t){t.callHandler("openMail",{email:e})});else{var r=document.createElement("a");r.href="mailto:"+e,r.click()}})},n.prototype.locationTo=function(e){var t=this;I.bridgeAvailable().then(function(n){var r="string"==typeof e?{url:e,showMode:"outer"}:w({showMode:"outer"},e);n?t.setUpBridge(function(e){e.callHandler("openUrl",r)}):"outer"===r.showMode?window.open(r.url):location.href=r.url})},n.prototype.url=function(e){return a(g("url","locationTo"),this.locationTo,this)(e)},n.prototype.showContact=function(e){this.setUpBridge(function(t){t.callHandler("openContactItem",{id:e})})},n.prototype.openContact=function(e){this.showContact(e)},n.prototype.selectContact=function(e,t){var n=this,r=w({user:[],type:"multiple",unselect:!0,limit:10},e);return new Promise(function(e,i){n.setUpBridge(function(n){n.callHandler("openContact",r,function(n){try{var r=h(n);"function"==typeof t&&(y("selectContact"),t(r)),e(r)}catch(e){i(e)}})})})},n.prototype.setBarColor=function(e){this.setUpBridge(function(t){t.callHandler("setBarColor",{color:e})})},n.prototype.setBarVisible=function(e){this.setUpBridge(function(t){t.callHandler("showBar",{flag:!e})})},n.prototype.showBar=function(e){I.windows()?this.setUpBridge(function(e){e.callHandler("showMenu",null)}):this.setBarVisible(!e||!0)},n.prototype.hideBar=function(){this.setBarVisible(!1)},n.prototype.settingBar=function(e,t){a("settingBar 已经废弃");var n=w({},E,e);this.setUpBridge(function(e){e.callHandler("setBar",w({},n,{hideMoreBtn:n.hideMoreBtn.toString()}),function(e){var n=h(e);"function"==typeof t&&t(n)})})},n.prototype.exitApp=function(){return a(g("exitApp","exit"),this.exit,this)()},n.prototype.date=function(){a("date() 方法已废弃， 请使用客户端日期组件代替")},n.prototype.getLocation=function(e,t){var n=this,r="function"==typeof e||null==e?D:w({},D,e),i="function"==typeof e?e:t;return new Promise(function(e,t){r.preferNative?(delete r.preferNative,n.setUpBridge(function(n){n.callHandler("getLocation",r,function(n){try{var r=h(n)[0],o=r.address,a=r.coordType,s=parseFloat(r.latitude),c=parseFloat(r.longitude),l=parseFloat(r.speed),u={latitude:s,longitude:c,address:o,speed:l=1e3*l/3600,accuracy:parseFloat(r.accuracy),coordType:"bd09ll"===a?"BD09":d(s,c)?"WGS84":"BD09"};"function"==typeof i&&(y("getLocation"),i(u)),e(u)}catch(e){t(e)}})})):navigator.geolocation.getCurrentPosition(function(t){var n=t.coords,r={latitude:n.latitude,longitude:n.longitude,accuracy:n.accuracy,speed:n.speed,coordType:"WGS84"};"function"==typeof i&&i(r),e(r)},function(e){var n=e.code,r=e.message;t(new C(n,r))},r)})},n.prototype.getLoc=function(e){a(g("getLoc","getLocation"),this.getLocation,this)(e)},n.prototype.geoNavigate=function(e,t){this.setUpBridge(function(n){var r={to:t,from:e,coordType:"WGS84"};n.callHandler("geoNavigate",r)})},n.prototype.apiInfos=function(e){var t=this;return new Promise(function(n,r){t.setUpBridge(function(t){t.callHandler("apiList",null,function(t){try{var i=h(t);"function"==typeof e&&(y("apiInfos"),e(i)),n({platform:i.plat,version:i.version,API:i.apilist})}catch(e){r(e)}})})})},n.prototype.getList=function(e){a(g("getList","apiInfos"),this.apiInfos,this)(e)},n.prototype.scanQRCode=function(e,t){var n=this,r="boolean"!=typeof e||e,i="function"==typeof e?e:t;return new Promise(function(e,t){n.setUpBridge(function(n){n.callHandler("scanQRCode",{needResult:r},function(n){try{var r=h(n);"function"==typeof i&&(y("scanQRCode"),i(r)),e(r)}catch(e){t(e)}})})})},n.prototype.QRcode=function(e,t){a(g("QRcode","scanQRCode"),this.scanQRCode)(e,t)},n.prototype.shareTo=function(){this.setUpBridge(function(e){e.callHandler("shareTo",null)})},n.prototype.openDialog=function(e){this.setUpBridge(function(t){t.callHandler("openDialog",e)})},n.prototype.Dialog=function(e,t){var n="object"==typeof e?e:{type:e,id:t};a(g("Dialog","openDialog"),this.openDialog)(n)},n.prototype.chooseImg=function(e,t){var n=this,r=null==e||"function"==typeof e?T:w({},T,e),i="function"==typeof e?e:t;return new Promise(function(e,t){n.setUpBridge(function(n){n.callHandler("chooseImg",r,function(n){try{var r=h(n);if("function"==typeof i&&(y("chooseImg"),i(r)),"true"===r.result){var o=r.imgData,a=r.imgHeight,s=r.imgWidth,c=r.imgType,l=r.quality;e({dataUrl:o,width:s,height:a,extension:c,quality:l})}else{var u=new C(r.errCode,r.errMsg);t(u)}}catch(e){t(e)}})})})},n.prototype.previewImg=function(e){var t=this;return new Promise(function(n,r){t.setUpBridge(function(t){t.callHandler("previewImg",e,function(e){try{var t=h(e);"true"===t.result?n():r(new C(t.errCode,t.errMsg))}catch(e){r(e)}})})})},n.prototype.openFile=function(e){var t=this;return new Promise(function(n,r){I.bridgeAvailable().then(function(i){i&&I.windows()?t.setUpBridge(function(t){t.callHandler("openFile",{url:e},function(e){var t=h(e);("boolean"==typeof t.result?t.result:"true"===t.result)?n():r(new C(t.errCode,t.errMsg))})}):(window.open(e),n())})})},n.prototype.addMenuItem=function(e,t){if(e in this.menuItems)throw new Error("[GZB-JSSDK]: 菜单项 "+e+" 已存在");this.addNativeMenuItem({id:String(P++),title:e},t)},n.prototype.removeMenuItem=function(e){var t=this;e in this.menuItems&&this.setUpBridge(function(n){n.callHandler("removeMenuItem",{ids:[t.menuItems[e]]}),delete t.menuItems[e]})},n.prototype.setNativeMenuItem=function(e){this.setUpBridge(function(t){t.callHandler("setNativeMenuItem",e)})},n.prototype.selectSession=function(e,t){var n=this,r=null==e||"function"==typeof e?N:w({},N,e),i="function"==typeof e?e:t;return new Promise(function(e,t){n.setUpBridge(function(n){n.callHandler("selectSession",r,function(n){try{var r=h(n);if("function"==typeof i&&(y("SelectSession"),i(r)),"true"===r.result)e(r.session);else{var o=new C(r.errCode,r.errMsg);t(o)}}catch(e){t(e)}})})})},n.prototype.getLanguage=function(e){var t=this;return new Promise(function(n,r){t.setUpBridge(function(t){t.callHandler("getLanguage",null,function(t){try{var i=h(t);if("function"==typeof e&&(y("getLanguage"),e(i)),"true"===i.result)n(i.language);else{var o=new C(i.errCode,i.errMsg);r(o)}}catch(e){r(e)}})})})},n.prototype.goback=function(){var e=this,t=window.location.href;window.history.go(-1),setTimeout(function(){window.location.href===t&&e.exit()},500)},n.prototype.teardown=function(){this.teardownEventWatchers()},n.prototype.addNativeMenuItem=function(e,t){var n=this,r=e.id,i=e.title;this.setUpBridge(function(o){n.menuItems[i]=r,o.callHandler("addMenuItem",e,function(r){var o=h(r);"true"===o.result?(t(null),i in n.menuItems&&n.addNativeMenuItem(e,t)):t(new C(o.errCode,o.errMsg))})})},n.prototype.setupEventWatchers=function(){this.setupBeforeUnloadWatcher(),this.setupBeforeGoBackWatcher()},n.prototype.teardownEventWatchers=function(){this.teardownBeforeUnloadWatcher(),this.teardownBeforeGoBackWatcher()},n.prototype.innerAddEventListener=function(t,n){return e.prototype.addListener.call(this,t,n)},n.prototype.setupBeforeGoBackWatcher=function(){var e=this;this.setupEventWatcher("beforegoback",function(){var t=new L("beforegoback",{cancelable:!0}),n=e.emit("beforegoback",t);t.defaultPrevented||n.some(function(e){return!1===e})||e.goback()})},n.prototype.teardownBeforeGoBackWatcher=function(){this.teardownEventWatcher("beforegoback")},n.prototype.teardownBeforeUnloadWatcher=function(){this.teardownEventWatcher("beforeunload")},n.prototype.setupBeforeUnloadWatcher=function(){var e=this,t=function(e){return e.some(function(e){return!1===e||"string"==typeof e&&""!==e})},n=function(e){return e.find(function(e){return"string"==typeof e&&""!==e})};this.setupEventWatcher("beforeunload",function(){var r=new L("beforeunload",{cancelable:!0}),i=e.emit("beforeunload",r);if(t(i)||r.defaultPrevented){var o=n(i)||r.returnValue;o&&window.confirm(o)&&e.exit()}else e.exit()})},n}(M),x={hideMoreBtn:!1,left:["goback","close"],onlyCallBack:[],gobackUrl:"",right:""},V=function(e){function n(){var t=e.call(this)||this;return t.listenerCount={beforegoback:0,beforeunload:0},t.setBarOptions=w({},x,{left:["goback","close"],onlyCallBack:[]}),t.mobileBridge=W.getInstance(),t}return t(n,e),n.getInstance=function(){return null==this.instance?this.instance=new n:this.instance},n.prototype.getBackButtonVisible=function(){return-1!==this.setBarOptions.left.indexOf("goback")},n.prototype.getCloseButtonVisible=function(){return-1!==this.setBarOptions.left.indexOf("close")},n.prototype.getMoreButtonVisible=function(){return!this.setBarOptions.hideMoreBtn},n.prototype.setMoreButtonVisible=function(e){void 0===e&&(e=!0),this.setBarOptions.hideMoreBtn=!e,this.setupBarWatcher()},n.prototype.setBackButtonVisible=function(e){void 0===e&&(e=!0),this.setBarButtonVisible(e,"goback")},n.prototype.setCloseButtonVisible=function(e){void 0===e&&(e=!0),this.setBarButtonVisible(e,"close")},n.prototype.setupEventWatcher=function(e,t){switch(e){case"beforeunload":this.setUpBeforeUnloadWatcher(t);break;case"beforegoback":this.setUpGobackWatcher(t);break;default:throw new Error("未知事件: "+e)}},n.prototype.teardownEventWatcher=function(e){switch(e){case"beforeunload":case"beforegoback":this._teardownBeforeUnloadWatcher();break;default:throw new Error("未知事件: "+e)}},n.prototype.setUpBridge=function(e){this.mobileBridge.setUpBridge(e)},n.prototype.setBarButtonVisible=function(e,t){var n=this.setBarOptions.left.indexOf(t);e&&-1===n?(this.setBarOptions.left.push(t),this.setupBarWatcher()):e||-1===n||(this.setBarOptions.left.splice(n,1),this.setupBarWatcher())},n.prototype.checkBarWatcher=function(e,t){if(this.listenerCount[t]&&-1!==this.setBarOptions.left.indexOf(e))-1===this.setBarOptions.onlyCallBack.indexOf(e)&&this.setBarOptions.onlyCallBack.push(e);else{var n=this.setBarOptions.onlyCallBack.indexOf(e);-1!==n&&this.setBarOptions.onlyCallBack.splice(n,1)}},n.prototype.setupBarWatcher=function(){var e=this;this.checkBarWatcher("goback","beforegoback"),this.checkBarWatcher("close","beforeunload"),this.setUpBridge(function(t){t.callHandler("setBar",w({},e.setBarOptions,{hideMoreBtn:e.setBarOptions.hideMoreBtn.toString()}),function(t){if(setTimeout(function(){e.setupBarWatcher()},0),"true"===t.result){var n="close"===t.buttonId?e.closeCallback:"goback"===t.buttonId?e.gobackCallback:null;n&&n()}})})},n.prototype._teardownBeforeUnloadWatcher=function(){this.setUpBridge(function(e){e.callHandler("setBar",w({},x,{hideMoreBtn:"false"}))})},n.prototype.watchListener=function(e){var t=this;this.innerAddEventListener("__addListener__",function(n){n.eventType===A[e]&&(t.listenerCount[e]++,t.setupBarWatcher())}),this.innerAddEventListener("__removeListener__",function(n){var r=n.eventType,i=n.count;r===A[e]&&(t.listenerCount[e]-=i,t.setupBarWatcher())}),(this.listenerCount[e]=this.getListenerLength(e))&&setTimeout(function(){t.setupBarWatcher()})},n.prototype.setUpBeforeUnloadWatcher=function(e){this.closeCallback=e,this.watchListener("beforeunload")},n.prototype.setUpGobackWatcher=function(e){this.gobackCallback=e,this.watchListener("beforegoback")},n}(S),G=function(e){function n(){var t=e.call(this)||this;return t.initializeBridge(),t}return t(n,e),n.getInstance=function(){return null==this.instance?this.instance=new n:this.instance},n.prototype.setUpBridge=function(e){e(this.bridge)},n.prototype.setupEventWatcher=function(e,t){switch(e){case"beforeunload":this.setUpBeforeUnloadWatcher(t);break;case"beforegoback":this.setUpBeforeGoBackWatcher(t);break;default:throw new Error("未知事件: "+e)}},n.prototype.teardownEventWatcher=function(e){switch(e){case"beforeunload":this._teardownBeforeUnloadWatcher();break;case"beforegoback":this._teardownBeforeGoBackWatcher();break;default:throw new Error("未知事件: "+e)}},n.prototype.setUpBeforeUnloadWatcher=function(e){var t=this;this.setUpBridge(function(n){n.callHandler("windowClose",null,function(){e(),t.setUpBeforeUnloadWatcher(e)})})},n.prototype._teardownBeforeUnloadWatcher=function(){this.setUpBridge(function(e){e.callHandler("windowClose",null)})},n.prototype.setUpBeforeGoBackWatcher=function(e){var t=this;this.setUpBridge(function(n){n.callHandler("pgGoBack",null,function(){e(),t.setUpBeforeGoBackWatcher(e)})})},n.prototype._teardownBeforeGoBackWatcher=function(){this.setUpBridge(function(e){e.callHandler("pgGoBack",null)})},n.prototype.initializeBridge=function(){this.bridge=H.getNormalizedBridge(),H.getInstance().registerHandler("setWebTitle",{beforeSend:function(e){return e.title}}).registerHandler("chooseImg").registerHandler("makeCallToNumber",{beforeSend:function(e){return e.callNumber}}).registerHandler("openMail",{beforeSend:function(e){return e.email}}).deprecatedRegisterHandler("openUrl",function(e){window.HandleEvent("On"+l("openUrl"),e.url,JSON.stringify(e))}).registerHandler("openContactItem",{beforeSend:function(e){return e.id}}).registerHandler("showMenu").registerHandler(O,{preserveName:!0}).registerHandler("apiList",{bridgeHandleName:"OnGetApiList"}).registerHandler("openDialog").registerHandler("openContact").registerHandler("selectSession").registerHandler("getLanguage").registerHandler("windowClose").registerHandler("pgGoBack").registerHandler("previewImg").registerHandler("openFile").registerHandler("addMenuItem").registerHandler("removeMenuItem").registerHandler("setNativeMenuItem").registerHandler("getEnvironment")},n}(S);!function(e){e[e.GroupChat=1]="GroupChat",e[e.Chat=2]="Chat",e[e.Announcement=3]="Announcement",e[e.Visitor=4]="Visitor"}(e.DialogType||(e.DialogType={})),function(e){e.refresh="refresh",e.share="share",e.copyLink="copyLink",e.openWithBrowser="openWithBrowser"}(e.NativeMenuItem||(e.NativeMenuItem={}));var J="JH.Detector已经废弃，请使用`import { Device } from 'gzb-jssdk'`代替",z=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.Android=a(J,t.android,t),t.BlackBerry=a(J,t.blackberry,t),t.IOS=a(J,t.ios,t),t.Windows=a(J,t.windows,t),t.isMobile=a(J,t.mobile,t),t.isWebkit=a(J,t.webkit,t),t.isiPad=a(J,t.ipad,t),t.isiPhone=a(J,t.iphone,t),t.isiPod=a(J,t.ipod,t),t}return t(n,e),n}(U);window.customApi={init:v},window.JH={Detector:new z},e.Api=S,e.BridgeResponseError=C,e.DesktopApi=G,e.Device=I,e.DeviceDector=U,e.EventEmitter=M,e.CustomEvent=L,e.MobileApi=V,e.Utils=B,e.VERSION="1.1.26-beta",e.api=v,e.default=v,Object.defineProperty(e,"__esModule",{value:!0})});
